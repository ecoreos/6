/* Copyright (c) 2016 Synology Inc. All rights reserved. */

tinymce.PluginManager.add("syno_fontselect",function(c,b){var a=this;c.addButton("syno_fontselect",function(){a.createFormats=function(j){j=j.split(";");var k=j.length;while(k--){j[k]=j[k].split("=")}return j};a.createMenu=function(j){var k=0,n=[];if(!j){return}for(k=0;k<j.length;k++){var m=j[k];var l={text:m.text,value:m.value,textStyle:m.textStyle};n.push(l)}return n};a.setActive=function(j,l){var k=0;a.value=l;for(k=0;k<j.length;k++){if(j[k].value()===l){j[k].active(true)}else{j[k].active(false)}}};a.createListBoxChangeHandler=function(i,j){return function(){var k=this;c.on("nodeChange",function(q){var m=c.formatter;var l=0,p="";var o=q.parents[0];for(l=0;l<i.length;l++){var n=i[l];if(j){if(m.matchNode(o,j,{value:n.value})){p=n.value;break}}else{if(m.matchNode(o,n.value)){p=n.value;break}}}k.value(p);a.value=p})}};var g="Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats";var f=0,e=[],h=a.createFormats(c.settings.font_formats||g);for(f=0;f<h.length;f++){var d=h[f];e.push({text:d[0],value:d[1],textStyle:d[1].indexOf("dings")==-1?"font-family:"+d[1]:""})}return{type:"menubutton",icon:"synofontselect",tooltip:"Font Family",menu:a.createMenu(e),fixedWidth:false,onPostRender:a.createListBoxChangeHandler(e,"fontname"),onselect:function(i){if(i.control.settings.value){a.setActive(this.menu.items(),i.control.settings.value);c.execCommand("FontName",false,i.control.settings.value)}},onClick:function(){a.setActive(this.menu.items(),a.value)}}})});