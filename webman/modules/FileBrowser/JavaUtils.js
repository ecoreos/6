/* Copyright (c) 2016 Synology Inc. All rights reserved. */

Ext.define("SYNO.SDS.DeployJava",{extend:"Object",debug:null,firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,getJavaURL:"http://java.com",oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",browserName:null,browserName2:null,getJREs:function(){var e=[];var d,a,c,b;if(this.isPluginInstalled()){d=this.getPlugin();a=d.jvms;for(c=0;c<a.getLength();c++){e[c]=a.get(c).version}}else{b=this.getBrowser();if(b=="MSIE"){if(this.testUsingActiveX("1.7.0")){e[0]="1.7.0"}else{if(this.testUsingActiveX("1.6.0")){e[0]="1.6.0"}else{if(this.testUsingActiveX("1.5.0")){e[0]="1.5.0"}else{if(this.testUsingActiveX("1.4.2")){e[0]="1.4.2"}else{if(this.testForMSVM()){e[0]="1.1"}}}}}}else{if(b=="Netscape Family"){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){e[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes("1.7")){e[0]="1.7.0"}else{if(this.testUsingMimeTypes("1.6")){e[0]="1.6.0"}else{if(this.testUsingMimeTypes("1.5")){e[0]="1.5.0"}else{if(this.testUsingMimeTypes("1.4.2")){e[0]="1.4.2"}else{if(this.browserName2=="Safari"){if(this.testUsingPluginsArray("1.7.0")){e[0]="1.7.0"}else{if(this.testUsingPluginsArray("1.6")){e[0]="1.6.0"}else{if(this.testUsingPluginsArray("1.5")){e[0]="1.5.0"}else{if(this.testUsingPluginsArray("1.4.2")){e[0]="1.4.2"}}}}}else{if(this.browserName2=="Opera"){if(this.testOperaUsingMimeTypes()){e[0]="0"}}}}}}}}}}}if(this.debug){for(c=0;c<e.length;++c){alert("We claim to have detected Java SE "+e[c])}}return e},installJRE:function(a){if(this.isPluginInstalled()){if(this.getPlugin().installJRE(a)){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}return true}else{return false}}else{return this.installLatestJRE()}},installLatestJRE:function(){var b,a;if(this.isPluginInstalled()){if(this.getPlugin().installLatestJRE()){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}return true}else{return false}}else{b=this.getBrowser();a=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(a.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("this.poll();",3000)}location.href=this.EarlyAccessURL;return false}else{if(b=="MSIE"){return this.IEInstall()}else{if((b=="Netscape Family")&&(a.indexOf("win32")!=-1)){return this.FFInstall()}else{location.href=this.getJavaURL+((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")}}return false}}},runApplet:function(b,f,d){if(d=="undefined"||d==null){d="1.1"}var e="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var a=d.match(e);if(this.returnPage==null){this.returnPage=document.location}var c;if(a!=null){c=this.getBrowser();if((c!="?")&&("Safari"!=this.browserName2)){if(this.versionCheck(d+"+")){this.writeAppletTag(b,f)}else{if(this.installJRE(d+"+")){this.refresh();location.href=document.location;this.writeAppletTag(b,f)}}}else{this.writeAppletTag(b,f)}}else{if(this.debug){alert("Invalid minimumVersion argument to runApplet():"+d)}}},writeAppletTag:function(d,h){var a="<applet ";var c="";var e="</applet>";var i=true;for(var b in d){if(d.hasOwnProperty(b)){a+=(" "+b+'="'+d[b]+'"');if(b=="code"||b=="java_code"){i=false}}}if(h!="undefined"&&h!=null){var g=false;for(var f in h){if(h.hasOwnProperty(f)){if(f=="codebase_lookup"){g=true}if(f=="object"||f=="java_object"){i=false}c+='<param name="'+f+'" value="'+h[f]+'"/>';if(!g){c+='<param name="codebase_lookup" value="false"/>'}}}}if(i){a+=(' code="dummy"')}a+=">";this.documentWrite(a+"\n"+c+"\n"+e)},versionCheck:function(h){var c=0;var f="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var a=h.match(f);var g,d,e,b;if(a!=null){e=true;b=[];for(d=1;d<a.length;++d){if((typeof a[d]=="string")&&(a[d]!="")){b[c]=a[d];c++}}if(b[b.length-1]=="+"){e=false;b.length--}else{if(b[b.length-1]=="*"){b.length--}}g=this.getJREs();if(g[0]=="0"){return true}for(d=0;d<g.length;++d){if(this.compareVersionToPattern(g[d],b,e)){return true}}return false}else{alert("Invalid versionPattern passed to versionCheck: "+h);return false}},getJPIVersionUsingMimeType:function(){var b,c,a;for(b=0;b<navigator.mimeTypes.length;++b){c=navigator.mimeTypes[b].type;a=c.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(a!=null){this.firefoxJavaVersion=a[1];break}}},isPluginInstalled:function(){var a=this.getPlugin();if(a&&a.jvms){return true}else{return false}},allowPlugin:function(){this.getBrowser();var a=("Safari"!=this.browserName2&&"Opera"!=this.browserName2);return a},getPlugin:function(){this.refresh();var a=null;if(this.allowPlugin()){a=document.getElementById("deployJavaPlugin")}return a},compareVersionToPattern:function(f,b,c){var g="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var h=f.match(g);var d,a,e,j;if(h!=null){e=0;j=[];for(d=1;d<h.length;++d){if((typeof h[d]=="string")&&(h[d]!="")){j[e]=h[d];e++}}a=Math.min(j.length,b.length);if(c){for(d=0;d<a;++d){if(j[d]!=b[d]){return false}}return true}else{for(d=0;d<a;++d){if(j[d]<b[d]){return false}else{if(j[d]>b[d]){return true}}}return true}}else{return false}},getBrowser:function(){var a;if(this.browserName==null){a=navigator.userAgent.toLowerCase();if(this.debug){alert("userAgent -> "+a)}if(Ext.isIE11||Ext.isIE){this.browserName="MSIE";this.browserName2="MSIE"}else{if(a.indexOf("firefox")!=-1){this.browserName="Netscape Family";this.browserName2="Firefox"}else{if(a.indexOf("chrome")!=-1){this.browserName="Netscape Family";this.browserName2="Chrome"}else{if(a.indexOf("safari")!=-1){this.browserName="Netscape Family";this.browserName2="Safari"}else{if(a.indexOf("mozilla")!=-1){this.browserName="Netscape Family";this.browserName2="Other"}else{if(a.indexOf("opera")!=-1){this.browserName="Netscape Family";this.browserName2="Opera"}else{this.browserName="?";this.browserName2="unknown"}}}}}}if(this.debug){alert("Detected browser name:"+this.browserName+", "+this.browserName2)}}return this.browserName},testUsingActiveX:function(a){var c="JavaWebStart.isInstalled."+a+".0";if(!ActiveXObject){if(this.debug){alert("Browser claims to be IE, but no ActiveXObject object?")}return false}try{return(new ActiveXObject(c)!=null)}catch(b){return false}},testForMSVM:function(){var b="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";var a;if(typeof oClientCaps!="undefined"){a=oClientCaps.getComponentVersion(b,"ComponentID");if((a=="")||(a=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(b){if(!navigator.mimeTypes){if(this.debug){alert("Browser claims to be Netscape family, but no mimeTypes[] array?")}return false}var c,a,d;for(c=0;c<navigator.mimeTypes.length;++c){d=navigator.mimeTypes[c].type;a=d.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(a!=null){if(this.compareVersions(a[1],b)){return true}}}return false},testOperaUsingMimeTypes:function(){if(!navigator.mimeTypes){if(this.debug){alert("Browser claims to be Netscape family, but no mimeTypes[] array?")}return false}var a,b;for(a=0;a<navigator.mimeTypes.length;++a){b=navigator.mimeTypes[a].type;if(b.indexOf("application/x-java-")!=-1){return true}}return false},testUsingPluginsArray:function(b){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var a=navigator.platform.toLowerCase();for(var c=0;c<navigator.plugins.length;++c){var d=navigator.plugins[c].description;if(d.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions("1.5.0",b)){return true}}else{if(d.search("Java")!=-1){if(a.indexOf("win")!=-1){if(this.compareVersions("1.5.0",b)||this.compareVersions("1.6.0",b)){return true}}}}}if(this.compareVersions("1.5.0",b)){return true}return false},IEInstall:function(){location.href=this.getJavaURL+((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):"");return false},done:function(b,a){},FFInstall:function(){location.href=this.getJavaURL+((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):"");return false},compareVersions:function(f,g){var d=f.split(".");var c=g.split(".");var e;for(e=0;e<d.length;++e){d[e]=Number(d[e])}for(e=0;e<c.length;++e){c[e]=Number(c[e])}if(d.length==2){d[2]=0}if(d[0]>c[0]){return true}if(d[0]<c[0]){return false}if(d[1]>c[1]){return true}if(d[1]<c[1]){return false}if(d[2]>c[2]){return true}if(d[2]<c[2]){return false}return true},enableAlerts:function(){this.browserName=null;this.debug=true},poll:function(){this.refresh();var a=this.getJREs();if((this.preInstallJREList.length==0)&&(a.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}if((this.preInstallJREList.length!=0)&&(a.length!=0)&&(this.preInstallJREList[0]!=a[0])){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}},writePluginTag:function(){var a=this.getBrowser();if(a=="MSIE"){this.documentWrite('<object classid="clsid:CAFEEFAC-DEC7-0000-0000-ABCDEFFEDCBA" id="deployJavaPlugin" width="0" height="0"></object>')}else{if(a=="Netscape Family"&&this.allowPlugin()){this.writeEmbedTag()}}},refresh:function(){navigator.plugins.refresh(false);var a=this.getBrowser();if(a=="Netscape Family"&&this.allowPlugin()){var b=document.getElementById("deployJavaPlugin");if(b==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var a=false;var b;if(navigator.mimeTypes!=null){for(b=0;b<navigator.mimeTypes.length;b++){if(navigator.mimeTypes[b].type==this.mimeType){if(navigator.mimeTypes[b].enabledPlugin){this.documentWrite('<embed id="deployJavaPlugin" type="'+this.mimeType+'" style="display: none" />');a=true}}}if(!a){for(b=0;b<navigator.mimeTypes.length;b++){if(navigator.mimeTypes[b].type==this.oldMimeType){if(navigator.mimeTypes[b].enabledPlugin){this.documentWrite('<embed id="deployJavaPlugin" type="'+this.oldMimeType+'" style="display: none" />')}}}}}},do_initialize:function(){this.writePluginTag();var b;if(this.locale==null){b=null;if(b==null){try{b=navigator.userLanguage}catch(a){}}if(b==null){try{b=navigator.systemLanguage}catch(a){}}if(b==null){try{b=navigator.language}catch(a){}}if(b!=null){b.replace("-","_");this.locale=b}}},documentWrite:function(a){Ext.DomHelper.createTemplate(a).append(document.body)}});window.deployJava=new SYNO.SDS.DeployJava();var AppletProgram={};Ext.apply(AppletProgram,{appletID:"applet",classname:"main/AppletHandler.class",blJava:false,blJavaPermission:0,blSetJavaPermission:0,JavaVersion:"1.5",blSet:false,setJava:function(a){if(this.blSet){return}this.blSet=true;if(true===this.checkJava()){this.runJava(a,this.JavaVersion)}},checkJava:function(){if(this.blJava){return this.blJava}if(Ext.isChrome||Ext.isOpera||(Ext.isSafari&&Ext.isWindows)){this.blJava=false}else{deployJava.do_initialize();this.blJava=this.checkVersion(this.JavaVersion)}return this.blJava},setJavaPermission:function(a){if(a){this.blSetJavaPermission=1}else{this.blJavaPermission=-1;this.blSetJavaPermission=-1}},updateFileStation:function(a){if(true===this.checkJava(this.JavaVersion)){this.updateFileStationDefer(a)}},isMatchVerion:function(){try{var a=document.getElementById(this.appletID).getVersion();var d=a.split("-",2);d[1]=d[1]||"s0";d[1]=parseInt(d[1].replace("s",""),10);var b=(_S("fullversion")||_S("version")).split("-",2);b[1]=b[1]||"s0";b[1]=parseInt(b[1].replace("s",""),10);return(parseInt(b[0],10)>=parseInt(d[0],10))&&(b[1]>=d[1])}catch(c){return false}},updateFileStationDefer:function(a){if(this.updateDeferTime){if(this.updateStartTime&&500<((new Date().getTime())-this.updateStartTime)){this.updateDeferTime=new Date().getTime()}if(!this.blJavaMsgShown&&20000<((new Date().getTime())-this.updateDeferTime)){this.setJavaPermission(false);a.showJavaMsg(true);this.blJavaMsgShown=true}}if(this.blSetJavaPermission!==0&&this.isRunning()){this.blJavaPermission=1;this.blMatchVersion=this.isMatchVerion();a.updateLocalEnv.call(a,this.blJavaPermission);a.getDownloadInstance().on("cancel",function(b){AppletProgram.action({action:"canceldownload",id:b})},this)}else{if(!this.updateDeferTime){this.updateDeferTime=new Date().getTime()}this.updateStartTime=new Date().getTime();this.updateFileStationDefer.createDelegate(this,[a]).defer(100)}},checkVersion:function(a){return(deployJava.versionCheck(a+"+"))},runJava:function(e,f){var d=SYNO.SDS.Utils.getPunyBaseURL();var b="webUI/sFILEAPP.jar";if(deployJava.versionCheck("1.7.0_45+")){b="webUI/sFILEAPP2.jar"}var a={id:this.appletID,code:this.classname,archive:d+e+b+"?v="+_S("fullversion"),width:1,height:1,MAYSCRIPT:"true",style:"position: absolute; left: -10000px;"};var c={host:d,baseURL:d+e,webapiURL:d+"webapi/_______________________________________________________entry.cgi?_sid="+Ext.util.Cookies.get("id"),sid:Ext.util.Cookies.get("id"),token:_S("SynoToken")||""};this.updateStartTime=new Date().getTime();deployJava.runApplet(a,c,f)},isDefined:function(a){return Ext.isDefined(typeof(a))},isRunning:function(){try{if(this.isDefined(document.getElementById(this.appletID))){if(Ext.isIE||Ext.isModernIE){return document.getElementById(this.appletID).isRunning()}else{if(document.getElementById(this.appletID).isRunning){return document.getElementById(this.appletID).isRunning()}}}return false}catch(a){return false}},action:function(d){var b=false,a=null;try{if(this.blMatchVersion){a=document.getElementById(this.appletID).action(Ext.util.JSON.encode(d));a=a?Ext.util.JSON.decode(a):null;b=true}}catch(c){b=false}if(!b){SYNO.SDS.Desktop.getMsgBox().alert(_T("tree","leaf_filebrowser"),_T("java","prompt_reopen"))}return a},checkResponse:function(b,a){if(!this.blMatchVersion){return}var c=_T("tree","leaf_filebrowser");if(!b){if(a){a.owner.getMsgBox().alert(c,_WFT("common","error_system"))}return false}else{if(b.errno&&b.errno.section&&b.errno.key){if(SYNO.webfm.utils.checkIfNeedRedirect(b.errno.section,b.errno.key,false)){return false}if(a){a.owner.getMsgBox().alert(c,_WFT(b.errno.section,b.errno.key))}}}return true},getUserPath:function(c,a){var b=this.action(c);if(this.checkResponse(b,a)){return b.userpath}return null},getHostName:function(c,a){var b=this.action(c);if(this.checkResponse(b,a)){return b.hostname}return""},getDiskInfo:function(b,a){var c=this.action(b);if(this.checkResponse(c,a)){return c}},showFileDialog:function(a,b){this.webfm=a;document.getElementById(this.appletID).showFileDialog(Ext.util.JSON.encode(b));if(SYNO.SDS.Desktop){SYNO.SDS.Desktop.getEl().mask();if(SYNO.SDS.TaskBar){SYNO.SDS.TaskBar.getEl().mask()}}},uploadFile:function(b,a){(function(){var c=a||this.webfm;c.FileAction.directlyUpload(b.remoteDir,b.files,b.blOverwrite)}).createDelegate(this).defer(50)},onSelectDest:function(b,a){(function(){var c=a||this.webfm;if(!b){return}switch(b.action){case"copy":case"move":c.FileAction.onJavaMVCP(b.action,b.remoteDir,b.files,b.blOverwrite);break;default:c.FileAction.onJavaDownload("copy",b.remoteDir,b.files,b.blOverwrite);break}}).createDelegate(this).defer(50)},onSelectError:function(b,a){(function(){var c=a||this.webfm;var d=String.format(_WFT("upload","upload_error_add"),b.files.join(", "));c.owner.getMsgBox().alert(_WFT("filetable","filetable_upload"),d)}).createDelegate(this).defer(50)},onSelectComplete:function(){(function(){if(SYNO.SDS.Desktop){SYNO.SDS.Desktop.getEl().unmask();if(SYNO.SDS.TaskBar){SYNO.SDS.TaskBar.getEl().unmask()}}}).createDelegate(this).defer(50)}});AppletProgram.DropPanel=Ext.extend(Object,{classname:"main/AppletDropPanel.class",constructor:function(a){this.webfm=a;this.runJava(a.RELURL)},getRandomNumber:function(){var d=new Date().getTime();var b;for(var a=d;a>0;a--){b=d.toString()+Math.floor(Math.random()*65535).toString();var c=Ext.getClassByName("AppletProgram.DropPanelInstance_"+b);if(!c){return b}}},runJava:function(e){if(1!==AppletProgram.blJavaPermission){return}var f="applet_"+this.getRandomNumber();this.appletID=f;AppletProgram["DropPanelInstance_"+f]=this;var b="webUI/sFILEAPP.jar";if(deployJava.versionCheck("1.7.0_45+")){b="webUI/sFILEAPP2.jar"}var d=SYNO.SDS.Utils.getPunyBaseURL();var a={id:f,code:this.classname,archive:d+e+b+"?v="+_S("fullversion"),MAYSCRIPT:"true",style:"position:absolute;z-index:8999;left:-100000px;top:0px;zoom:1;"};var c={appletid:f,lang:_S("lang")};deployJava.runApplet(a,c,AppletProgram.JavaVersion)},showDropPanel:function(){var b=this.webfm.viewPanel.getEl();if(1!==AppletProgram.blJavaPermission||b.isMasked()){return}if(!this.el){this.el=Ext.get(this.appletID);var a=b;a.appendChild(this.el);this.el.setSize("100%","100%");this.el.setLeftTop(0,0);this.el.enableDisplayMode()}this.el.show()},hideDropPanel:function(){if(1!==AppletProgram.blJavaPermission||!this.el){return}this.el.hide()},onSelectError:function(a){(function(){this.webfm.el.unmask();AppletProgram.onSelectError(a,this.webfm)}).createDelegate(this).defer(50)},onDropError:function(a){(function(){this.webfm.el.unmask();var b=_WFT("error","error_system_busy");if(a.errno){b=_WFT(a.errno.section,a.errno.key)}this.webfm.owner.getMsgBox().alert(_WFT("filetable","filetable_upload"),b)}).createDelegate(this).defer(50)},onDropFiles:function(a){(function(){this.hideDropPanel();this.webfm.owner.el.unmask();var b=(SYNO.SDS.UserSettings.getProperty("SYNO.SDS.App.PersonalSettings.Instance","enableautooverwrite")===true)?true:false;if(!this.webfm.onCheckVFSAction("upload",null,this.webfm.getUploadPath())){this.webfm.owner.getMsgBox().alert(_WFT("filetable","filetable_upload"),_WFT("error","not_support"));return false}if(!this.webfm.onCheckPrivilege("upload",null,false,false)){this.webfm.owner.getMsgBox().alert(_WFT("filetable","filetable_upload"),_WFT("error","error_privilege_not_enough"));return false}var c=new SYNO.FileStation.DropConfirmDialog({owner:this.webfm.owner},{cb:{fn:function(d,e){AppletProgram.uploadFile(Ext.apply(a,{remoteDir:this.webfm.getCurrentDir(),blOverwrite:e.overwrite}),this.webfm)},scope:this,files:a.files},filenames:a.files});if(b){c.upload(b)}else{c.show()}this.processing=false}).createDelegate(this).defer(50)},onDropStart:function(){this.processing=true;(function(){if(!this.webfm.owner.el.isMasked()){this.webfm.owner.el.mask(_WFT("common","loading"),"x-mask-loading")}}).createDelegate(this).defer(50)},onDestroy:function(){},onDragOver:function(){this.webfm.viewPanel.html5cfg.html5uploader.dragstarttime=new Date().getTime();this.showDropPanel()}});AppletProxy=function(a){var b={};b[Ext.data.Api.actions.read]=true;AppletProxy.superclass.constructor.call(this,{api:b});this.webfm=a};Ext.extend(AppletProxy,Ext.data.DataProxy,{doRequest:function(e,c,f,b,g,d,a){f=f||{};(function(){var h;try{var j=AppletProgram.action(f);if(!j){var k=_T("tree","leaf_filebrowser");this.webfm.owner.getMsgBox().alert(k,_WFT("common","error_system"));return}else{if(j.errno){this.fireEvent("exception",this,"response",e,a,j,null);return}else{h=b.readRecords(j)}}}catch(i){this.fireEvent("exception",this,"response",e,a,j,i);g.call(d,null,a,false);return}g.call(d,h,a,true)}).defer(10,this)}});AppletTreeLoader=function(b,a){this.params=b;this.webfm=a;AppletTreeLoader.superclass.constructor.call(this)};Ext.extend(AppletTreeLoader,Ext.tree.TreeLoader,{load:function(a,b){if(this.clearOnLoad){while(a.firstChild){a.removeChild(a.firstChild)}}if(this.Appletload(a)){if(typeof b=="function"){b()}}},Appletload:function(c){try{var g={node:(c.id==="fm_local_root")?"fm_local_root":c.attributes.path,isHome:(c.attributes.type==="localh")};Ext.apply(g,this.params);var f=AppletProgram.action(g);if(AppletProgram.checkResponse(f,this.webfm)){c.beginUpdate();for(var b=0,a=f.length;b<a;b++){var h=this[(c.id==="fm_local_root")&&(f[b].type!=="localh")?"createDiskNode":"createNode"](f[b]);if(h){c.appendChild(h)}}c.endUpdate();return true}return false}catch(d){this.webfm.owner.getMsgBox().alert(_T("tree","leaf_filebrowser"),_WFT("common","error_system"));return false}},createDiskNode:function(a){var b=AppletProgram.getDiskInfo({action:"getfs",cwd:a.path},this);if(b&&b.free&&b.total){a.freeSpace=b.free;a.totalSpace=b.total;SYNO.webfm.utils.setSpaceTooltip(a)}return Ext.tree.TreeLoader.prototype.createNode.call(this,a)}});